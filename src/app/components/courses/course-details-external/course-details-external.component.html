<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' }">
</ngx-loading>

<div class="container" *ngIf="model">
  <div class="row">

    <!--Details and Video Section-->
    <div class="col-8">
      <!--Course Details-->
      <div *ngIf="!currentContent">
        <h1>{{model.title}}</h1>
        <h6>by {{model.teacher.user.name}}</h6>

        <p class="text-justify mt-4 pt-4">{{model.description}}</p>

        <button class="btn btn-success mt-4 px-4"
          (click)="changeVideo(model.contents[0].subContents? model.contents[0].subContents[0]: model.contents[0])">Start
          Course</button>
      </div>

      <!--Video Section-->
      <div *ngIf="currentContent">
        <div class="p-3 mb-2 bg-dark text-white shadow-lg p-3 rounded">
            <button class="btn-secondary float-right" (click)="changeVideo(null)">back</button>
            <h3 >{{currentContent.title}}</h3>
        </div>

        <video style="width: 100%" height="380px"  src="{{currentContent.video}}" controls>
        </video>

      </div>
    </div>

    <!--Content Section-->
    <div class="col-4">
      <div class="accordion" id="accordionExample">
        <div class="card" *ngFor="let content of model.contents; let idx = index;">

          <!--Card Header-->
          <div class="card-header" id=heading{{idx}}>
            <h2 class="mb-0">
              <button class="btn btn-link" type="button" data-toggle="collapse" [attr.data-target]="'#collapse' + idx"
                aria-expanded="true" aria-controls="collapseOne">
                {{content.title}}
              </button>
            </h2>
          </div>

          <!--Card Body-->
          <div id=collapse{{idx}} class="collapse" [ngClass]="{'show': idx==0}" [attr.aria-labelledby]="'heading' + idx"
            data-parent="#accordionExample">
            <div class="card-body">

              <!-- If no SubContent-->
              <div (click)="changeVideo(content)" *ngIf="!content.subContents">
                <ul class="list-group">
                  <li
                    class="list-group-item d-flex justify-content-between align-items-center list-group-item-action list-group-item-dark cursor">
                    <div (click)="changeVideo(content)">{{content.title}} </div>
                    <span class="badge badge-primary badge-pill">1:38</span>
                  </li>
                </ul>
              </div>

              <!--If SubContent Present-->
              <ul class="list-group" *ngFor="let subContent of content.subContents">
                <li
                  class="list-group-item d-flex justify-content-between align-items-center list-group-item-action list-group-item-dark cursor">
                  <div (click)="changeVideo(subContent)">{{subContent.title}} </div>
                  <span class="badge badge-primary badge-pill">3:12</span>
                </li>
              </ul>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>